
	<script type="text/javascript">
	$(function() {
		
		
		$("tbody").sortable({items: 'td', containment: 'table' });
		$("td").hoverbox();

	});
	</script>
<% content_for(:head) do %>
 
	<script type="text/javascript">
		$(function(){
  //Get our elements for faster access and set overlay width
  var div = $('div.sc_menu'),
               ul = $('ul.sc_menu'),
               // unordered list's left margin
               ulPadding = 15;
							 
	var btn_left = $('div.btn_left');
	var btn_right = $('div.btn_right');
	var offset = 0;

  //Get menu width
  var divWidth = div.width();

  //Remove scrollbars
  div.css({overflow: 'hidden'});

  //Find last image container
  var lastLi = ul.find('li:last-child');

  //When user move mouse over menu
  div.mousemove(function(e){
    //As images are loaded ul width increases,
    //so we recalculate it each time
    var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;

    var left = (e.pageX - div.offset().left) * (ulWidth-divWidth) / divWidth;
    div.scrollLeft(left);
  });
	
	
	btn_left.click(function(e){
		if (offset < divWidth + 120) {offset = offset + 50;}
		var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;
		var left = (offset - div.offset().left) * (ulWidth-divWidth) / divWidth;
		div.scrollLeft(left);
	});
	
	btn_right.click(function(e){
	
	offset = offset - 50;
	var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;
	var left = (offset - div.offset().left) * (ulWidth-divWidth) / divWidth;
	div.scrollLeft(left);
	});
	
});
	</script>
<% end %>	


	
	
<div class="btn_left"> <%= image_tag('arrow_left_light.png', :id=> "btn_left", :mouseover => "arrow_left_dark.png" , :border=>0) %>
</div>
<div class="sc_menu">
	<div id="members">
		<% @id = @calendar.id %>
		<ul class="sc_menu">
			<% @family.each do |member|%>
					<li>
					<%= member.login %>
					<% if member.photo.exists? %>
						<a href="#"><%= image_tag(member.photo.url) %> </a>
					<% else %>
						<a href="#"><%= image_tag('girl.jpg') %> </a>
					<% end %>
					</li>
			<% end %>
			<% @family.each do |member|%>
					<li>
					<%= member.login %>
					<% if member.photo.exists? %>
						<a href="#"><%= image_tag(member.photo.url) %> </a>
					<% else %>
						<a href="#"><%= image_tag('girl.jpg') %> </a>
					<% end %>
					</li>
			<% end %>
		</ul>
	</div>
</div>
<div class="btn_right"><%= image_tag('arrow_right_light.png', :id => "btn_right", :mouseover => "arrow_right_dark.png", :border =>0) %></div>

<%
=begin %>
<div id="calendar_grid">
<% 7.times  do |x|%>
<ul id ="calendar_entries">
  <% time = Time.now.beginning_of_week + x * 86400%>
  <li id="name_of_day">
    <%= time.strftime("%d") %>
		<br />
		<%= time.strftime("%A") %>
  </li>

  <% unless @calendar.events.empty? %>
    <% @calendar.events.each do |event| %>
      <% if event.start_on.day == time.day %>
		<li id=time.day>
		   <%=h event.description %><br/>
		   <%=h event.user.login %>
		   <%= image_tag(event.chore.image_url) %> 
		</li>
	  <% end %>
    <% end %>
  <% end %>  
</ul>
<% end %>
</div>
<%
=end %>

<div id= "calendar_grid">
<table>
<tr id ="calendar_entries">
<% 7.times  do |x|%>
    <% time = Time.now.beginning_of_week + x * 86400%>
    <td id="name_of_day">
      <%= time.strftime("%a") %>
	  <p class="day"><%= time.strftime("%d") %></p>
    </td>
<% end %>
 </tr>
 <tbody>
<% usedAlready = {} %>
<% 4.times  do |a|%>
  <tr>
  <% 7.times do |x| %>
    <% time = Time.now.beginning_of_week + x * 86400%>
	      <td>
			 <% z=0 %>
				<% @entries.each do |event| %>
					<% if event.start_on.day == time.day && !usedAlready.has_key?(z)%>
					  <!--[if IE]>
						<%= @spantitle = "<span title='#{event.description}'>" %>
						<![endif]-->
						<![if !IE]>
						<%= @spantitle = "<span class='tip' onmouseover=\"tooltip('#{event.description}');\" onmouseout='exit();'>" %>
						<![endif]>
							<%= image_tag(event.chore.image_url) %> 
							<% usedAlready[z] = true %>
							<% break %>
						</span>
					<% end %>
					<% z= z+1 %>
				<% end %>
		  </td>
	
	<% end %>
  </tr>
<% end %>
</tbody>
</table>
</div>


<div id="details">

<div id="events">
<h3>Events</h3>

<% unless @calendar.events.empty? %>
  <% @calendar.events.each do |event| %>
    <p>
	  <%=h event.description %><br/>
      <%=h event.start_on.strftime('%d.%m.%Y') %>
	</p>
	<p>
	  <%= link_to 'Show Event', [@calendar, event] %> |
	  <% if permitted_to? :edit, @event %>
	    <%= link_to 'Edit Event', [:edit, @calendar, event] %> |
	  <% end %>
	  <% if permitted_to? :destroy, @event %>
	    <%= link_to 'Destroy Event', [@calendar, event], :confirm => 'Are you sure?', :method => :delete %>
	  <% end %>

	</p><br/>
  <% end %>
<% end %>
</div>
<div id="chores">
<% if permitted_to? :create, @chore %>
  <h3>Create Chores</h3>
  <%= render :partial => @chore = Chore.new, :locals => { :button_name => 'Create'} %>
<% end %>
<% if !@calendar.chores.empty? %>
<h3>Create new event</h3>
<%= render :partial => @event = Event.new, :locals => { :button_name => 'Create'}%>
<% end %>
</div>
<h3>Create Rewards</h3>
<%= render :partial => @reward = Reward.new, :locals => { :button_name => 'Create'}%>
</div>