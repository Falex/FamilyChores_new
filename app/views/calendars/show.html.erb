
	<script type="text/javascript">
	$(function() {
		
		
		$("tbody").sortable({items: 'td', containment: 'table' });
		$("td").hoverbox();

	});
	
	$(document).ready(function() {
    $("#accordion").accordion();
  });

	</script>
	
<% content_for(:head) do %>
<%= javascript_include_tag 'jquery.em', 'jquery.onImagesLoad', 'jquery.mousewheel', 'jScrollPlane' %>

 
	<script type="text/javascript">
	


	
	$(document).ready(function(){

	//Hide (Collapse) the toggle containers on load
	$(".toggle_container").hide(); 
	$(".rating").hide();
	$(".chores").hide();
	$(".events").hide();
	
	
	

	//Switch the "Open" and "Close" state per click then slide up/down (depending on open/close state)
	$("div.trigger").click(function(){
		$(this).toggleClass("active").next().slideToggle("slow");
		
	});
	
	$("div.calendar_entry").click(function(){
		$(this).toggleClass("active").next().slideToggle("slow");
	});

	$("div.checkbox").click(function(event){
	
		var color = $(this).children('p').html();
		var help = ".calendar_entry ." + color;
		$(help).toggle(400);
		$(this).children('div').children('img').toggle();
		
		return false;
	}); 
	
	$("div.upload").click(function(event){
		$('.chores').toggle(200);
	});
	
	$("div.newEvent").click(function(event){
		$('.events').toggle(200);
	});
	
	
	<!--$(color).toggle(400);return false;}); -->

});


	
		$(function(){
  //Get our elements for faster access and set overlay width
  var div = $('div.sc_menu'),
               ul = $('ul.sc_menu'),
               // unordered list's left margin
               ulPadding = 15;
							 
	var btn_left = $('div.btn_left');
	var btn_right = $('div.btn_right');
	var offset = 0;

  //Get menu width
  var divWidth = div.width();

  //Remove scrollbars
  div.css({overflow: 'hidden'});

  //Find last image container
  var lastLi = ul.find('li:last-child');

  //When user move mouse over menu
  div.mousemove(function(e){
    //As images are loaded ul width increases,
    //so we recalculate it each time
    var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;

    var left = (e.pageX - div.offset().left) * (ulWidth-divWidth) / divWidth;
    div.scrollLeft(left);
  });
	
	
	btn_left.click(function(e){
		if (offset < divWidth + 120) {offset = offset + 50;}
		var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;
		var left = (offset - div.offset().left) * (ulWidth-divWidth) / divWidth;
		div.scrollLeft(left);
	});
	
	btn_right.click(function(e){
	
	offset = offset - 50;
	var ulWidth = lastLi[0].offsetLeft + lastLi.outerWidth() + ulPadding;
	var left = (offset - div.offset().left) * (ulWidth-divWidth) / divWidth;
	div.scrollLeft(left);
	});
	
});
	</script>
<% end %>

<% content_for(:nav) do %>
<div class = "trigger"><%= image_tag('Aufgaben_light.png') %> </div>
<div class="toggle_container">
	<div class="upload"><%= image_tag('../images/Buttons/Uploadicon.png') %></div>
	<div class="newEvent"><%= image_tag('../images/Buttons/Beschriftung.png') %></div>
	<div class = "block">
			<% @calendar.chores.each do |chore| %>
				<%= image_tag(chore.image_url) %>
				<%= chore.title %>
			<% end %>
	</div>
</div>


<% end %>
	
	
<div class="btn_left"> 
</div>
<div class="sc_menu">
	<div id="members">
		<% @id = @calendar.id %>
		<ul class="sc_menu">
			<% @family.each do |member|%>
			    <li>
						<%= member.login %>
						<% frame = "<div class = '#{member.color}'>"%>
						<%= frame %>
							<% if member.photo.exists? %>
								<a href="#"><%= image_tag(member.photo.url) %> </a>
							<% else %>
								<a href="#"><%= image_tag('girl.jpg') %> </a>
							<% end %>
						</div>
						<div class = "checkbox"> 
							<div>
							<%= image_tag('../images/Kalender/hackerl_on.png') %>
							</div>
							<p><%= member.color %></p>
						</div>
					</li>
			<% end %>
			<% @family.each do |member|%>
			    <li>
						<%= member.login %>
						<% frame = "<div class = '#{member.color}'>"%>
						<%= frame %>
							<% if member.photo.exists? %>
								<a href="#"><%= image_tag(member.photo.url) %> </a>
							<% else %>
								<a href="#"><%= image_tag('girl.jpg') %> </a>
							<% end %>
						</div>
					</li>
			<% end %>
			
		</ul>
	</div>
</div>
<div class="btn_right"></div>
<ul>
	<div class="chores">
		<li>
			<% if permitted_to? :create, @chore %>
				<h3>Create Chores</h3>
				<%= render :partial => @chore = Chore.new, :locals => { :button_name => 'Create'} %>
			<% end %>
		</li>
	</div>
	<div class="events">
		<li>
			<% if !@calendar.chores.empty? %>
				<h3>Create new event</h3>
				<%= render :partial => @event = Event.new, :locals => { :button_name => 'Create'}%>
			<% end %>
		</li>
	</div>
<ul>
<div id= "calendar_grid">
<table>
<tr id ="calendar_entries">
<% 7.times  do |x|%>
    <% time = Time.now.beginning_of_week + x * 86400%>
    <td id="name_of_day">
      <%= time.strftime("%a") %>
	  <p class="day"><%= time.strftime("%d") %></p>
    </td>
<% end %>
 </tr>
 <tbody>
<% usedAlready = {} %>
<% 4.times  do |a|%>
  <tr>
  <% 7.times do |x| %>
    <% time = Time.now.beginning_of_week + x * 86400%>
	      <td>
			 <% z=0 %>
				<% @entries.each do |event| %>
					<div class= "calendar_entry">
						<% if event.start_on.day == time.day && !usedAlready.has_key?(z)%>
							<!--[if IE]>
							<%= @spantitle = "<span title='#{event.description}'>" %>
							<![endif]-->
							<![if !IE]>
							<%= @spantitle = "<span class='tip' onmouseover=\"tooltip('#{event.description}');\" onmouseout='exit();'>" %>
							<![endif]>
								<% frame = "<div class = '#{event.user.color}'>"%>
								<%= frame %>
									<%= image_tag(event.chore.image_url) %> 
								</div>
					</div>
								<div class="rating">
									<div class="block">
										<%= link_to image_tag('../images/Kalender/Wolke_Bewertung_inaktiv.png', :mouseover => '../images/Kalender/Wolke_Bewertung_aktiv.png', :border=>0), :action => 'addCloud', :id => event.user.id, :controller => "users" %>
										<%= link_to image_tag('../images/Kalender/Stern_Bewertung_inaktiv.png', :mouseover => '../images/Kalender/Stern_Bewertung_aktiv.png', :border=>0), :action => 'addStar', :id => event.user.id, :controller => "users" %>
								
									</div>
								</div>
								<% usedAlready[z] = true %>
								<% break %>
							</span>
						<% end %>
						<% z= z+1 %>
					
				<% end %>
		  </td>
	
	<% end %>
  </tr>
<% end %>
</tbody>
</table>
</div>




<div id="details">
	<div id="events">
		<h3>Events</h3>
		<% unless @calendar.events.empty? %>
			<% @calendar.events.each do |event| %>
				<p>
				<%=h event.description %><br/>
					<%=h event.start_on.strftime('%d.%m.%Y') %>
			</p>
			<p>
				<%= link_to 'Show Event', [@calendar, event] %> |
				<% if permitted_to? :edit, @event %>
					<%= link_to 'Edit Event', [:edit, @calendar, event] %> |
				<% end %>
				<% if permitted_to? :destroy, @event %>
					<%= link_to 'Destroy Event', [@calendar, event], :confirm => 'Are you sure?', :method => :delete %>
				<% end %>

			</p><br/>
			<% end %>
		<% end %>
	</div>
	<h3>Create Rewards</h3>
	<%= render :partial => @reward = Reward.new, :locals => { :button_name => 'Create'}%>
</div>